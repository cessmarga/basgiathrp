<!DOCTYPE html>
<html>
<head><title>Admin Panel</title>
      <style>
        table, th, td {
            border: 1px solid #444;
            border-collapse: collapse;
            padding: 8px;
        }
        th { background-color: #eee; }
    </style>
</head>
<body>
    <p style="text-align: right;"><a href="{{ url_for('admin_logout') }}">Logout</a></p>
    <a href="{{ url_for('download_db') }}">
        <button type="button" style="text-align: right;">⬇️ Download Database</button>
    </a>
    <h2>Welcome, Admin</h2>
    <p><a href="{{ url_for('add_user') }}">← Add Users</a></p>
    
    <table>
        <thead>
            <tr>
                <th>Username</th>
                <th>Group</th>
                <th>Grad</th>
                <th>Leader</th>
                <th>Pre-War</th>
                <th>Frontlines</th>
                <th>Disability</th>
                <th>Age</th>
                <th>Magic</th>
                <th>Fighter</th>
                <th>Attack Modifier</th>
                <th>Attack %</th>
                <th>Defend Modifier</th>
                <th>Defend %</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user['username'] }}</td>
                <td>{{ user['member_group'] }}</td>
                <td>{{ 'Yes' if user['graduate'] == 'yes' else 'No' }}</td>
                <td>{{ 'Yes' if user['leadership'] == 'yes' else 'No' }}</td>
                <td>{{ user['pre_war_status'] }}</td>
                <td>{{ 'Yes' if user['frontlines'] == 'yes' else 'No' }}</td> 
                <td>{{ 'Yes' if user['disability'] == 'yes' else 'No' }}</td>
                <td>{{ user['age'] }}</td>
                <td>{{ user['magic_type'] }}</td>
                <td>{{ user['fighter_type'] }}</td>
                <td>{{ user['attack_success'] }}%</td>
                <td>{{ user['attack_odds'] }}%</td>
                <td>{{ user['defend_success'] }}%</td>
                <td>{{ user['defend_odds'] }}%</td>
                <td>
                  <form action="{{ url_for('reset_user', user_id=user['id']) }}" method="POST" onsubmit="return confirm('Are you sure you want to reset user to base stats?');">
                    <button type="submit" class="btn btn-danger btn-sm">Reset</button>
                  </form>
                  <form action="{{ url_for('delete_user', user_id=user['id']) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this user?');">
                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                  </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
